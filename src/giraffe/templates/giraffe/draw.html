{% load url from future %}
<!DOCTYPE HTML>
<html>
<head>
  <link href="/static/giraffe/vendor/jquery-ui-1.9.2.custom/css/smoothness/jquery-ui-1.9.2.custom.min.css"
        rel="stylesheet" type="text/css" />
  <link href="/static/giraffe/stylesheets/demo.css" rel="stylesheet" type="text/css" />
</head>
<body>

<div id="header">
  <div id="title">Giraffe: DNA Sequence Analysis</div>
  <p>
    Feature Detection, Sequence Maps, Digests, and more ...
  </p>
</div>

<h2>Draw Plasmid Map from Raw or Genbank Sequence</h2>

<div id="post-form">
  <input type="hidden" name="db" value="default" />
  <textarea name="sequence" class="sequence">
ctcttcgctactatgagtggttgctggataactttacgggcatgcataaggctcgtatgatatattcagggagaccacaacggtttccctctacaaataattttgtttaacttttcacacaggaaagtactagatgaccatgattacggattcactggccgtcgttttacaacgtcgtgactgggaaaaccctggcgttacccaacttaatcgccttgcagcacatccccctttcgcaagctggcgtaatagcgaggaggcccgcaccgatcgcccttcccaacagttgcgcagcctgaatggcgaatggcgcgcgggcggcagcgaaggcggcggcagcgaacatcatcatcatcatcatggcagcgaacgtaaaggagaagaacttttcactggagttgtcccaattcttgttgaattagatggtgatgttaatgggcacaaattttctgtcagtggagagggtgaaggtgatgcaacatacggaaaacttacccttaaatttatttgcactactggaaaactacctgttccatggccaacacttgtcactaccctgacctatggtgttcaatgctttgcgagatacccagatcatatgaaacagcatgactttttcaagagtgccatgcccgaaggttatgtacaggaaagaactatatttttcaaagatgacgggaactacaagacacgtgctgaagtcaagtttgaaggtgatacccttgttaatagaatcgagttaaaaggtattgattttaaagaagatggaaacattcttggacacaaattggaatacaactataactcacacaatgtatacatcatggcagacaaacaaaagaatggaatcaaagttaacttcaaaattagacacaacattgaagatggaagcgttcaactagcagaccattatcaacaaaatactccaattggcgatggccctgtccttttaccagacaaccattacctgtccacacaatctgccctttcgaaagatcccaacgaaaagagagaccacatggtccttcttgagtttgtaacagctgctgggattacacatggcatggatgaactatacaagtaagcccgaagagcacgtactgctaagctgactgcgggggagagcgcgtgtccgctgcagtccggcaaaaaagggcaaggtgtcaccaccctgccctttttctttaaaaccgaaaagattacttcgcgttatgcaggcttcctcgctcactgactcgctgcgctcggtcgttcggctgcggcgagcggtatcagctcactcaaaggcggtaatacggttatccacagaatcaggggataacgcaggaaagaacatgtgagcaaaaggccagcaaaaggccaggaaccgtaaaaaggccgcgttgctggcgtttttccacaggctccgcccccctgacgagcatcacaaaaatcgacgctcaagtcagaggtggcgaaacccgacaggactataaagataccaggcgtttccccctggaagctccctcgtgcgctctcctgttccgaccctgccgcttaccggatacctgtccgcctttctcccttcgggaagcgtggcgctttctcatagctcacgctgtaggtatctcagttcggtgtaggtcgttcgctccaagctgggctgtgtgcacgaaccccccgttcagcccgaccgctgcgccttatccggtaactatcgtcttgagtccaacccggtaagacacgacttatcgccactggcagcagccactggtaacaggattagcagagcgaggtatgtaggcggtgctacagagttcttgaagtggtggcctaactacggctacactagaagaacagtatttggtatctgcgctctgctgaagccagttaccttcggaaaaagagttggtagctcttgatccggcaaacaaaccaccgctggtagcggtggtttttttgtttgcaagcagcagattacgcgcagaaaaaaaggatctcaagaagatcctttgatcttttctacggggtctgacgctcagtggaacgaaaactcacgttaagggattttggtcatgagattatcaaaaaggatcttcacctagatccttttaaattaaaaatgaagttttaaatcaatctaaagtatatatgagtaaacttggtctgacagctcgaggcttggattctcaccaataaaaaacgcccggcggcaaccgagcgttctgaacaaatccagatggagttctgaggtcattactggatctatcaacaggagtccaagcgagctcgatatcaaattacgccccgccctgccactcatcgcagtactgttgtaattcattaagcattctgccgacatggaagccatcacaaacggcatgatgaacctgaatcgccagcggcatcagcaccttgtcgccttgcgtataatatttgcccatggtgaaaacgggggcgaagaagttgtccatattggccacgtttaaatcaaaactggtgaaactcacccagggattggctgagacgaaaaacatattctcaataaaccctttagggaaataggccaggttttcaccgtaacacgccacatcttgcgaatatatgtgtagaaactgccggaaatcgtcgtggtattcactccagagcgatgaaaacgtttcagtttgctcatggaaaacggtgtaacaagggtgaacactatcccatatcaccagctcaccgtctttcattgccatacgaaattccggatgagcattcatcaggcgggcaagaatgtgaataaaggccggataaaacttgtgcttatttttctttacggtctttaaaaaggccgtaatatccagctgaacggtctggttataggtacattgagcaactgactgaaatgcctcaaaatgttctttacgatgccattgggatatatcaacggtggtatatccagtgatttttttctccattttagcttccttagctcctgaaaatctcgataactcaaaaaatacgcccggtagtgatcttatttcattatggtgaaagttggaacctcttacgtgcccgatcaactcgagtgccacttgacgtctaagaaaccattattatcatgacattaacctataaaaataggcgtatcacgaggcagaatttcagataaaaaaaatccttagctttcgctaaggatgatttctggaattcgcggccgcttctagagcc
</textarea>
  <p>Only draw GB features: <input type="checkbox" name="gbonly" value="1"></p>
  <p class="button"><a href="#">Try It</a></p>

</div>

<div id="giraffe-map"></div>

<script src="/static/giraffe/vendor/raphael-min.js"></script>
<script src="/static/giraffe/vendor/jquery-1.9.0.min.js"></script>
<script src="/static/giraffe/vendor/jquery-ui-1.9.2.custom/js/jquery-ui-1.9.2.custom.min.js"></script>

<script src="/static/giraffe/javascripts/giraffe/scale.raphael.js"></script>
<script src="/static/giraffe/javascripts/giraffe/draw.js"></script>

<script>

jQuery(document).ready(function($){
  $('#post-form .button a').click(function(evt){
    evt.preventDefault();
    var analyzer_dom_id = 'giraffe-map';
    $('#'+analyzer_dom_id).empty();

    var seq = $('#post-form textarea[name=sequence]').val();
    var db = $('#post-form input[name=db]').val();
    var gbonly = $('#post-form input[name=gbonly]:checked').val();
    if (gbonly === undefined) { gbonly = 0; }

    if (seq !== undefined && seq.length > 0) {
      $.post("{% url 'giraffe-analyze' %}",
             { "sequence": seq, "db": db, "gbonly": gbonly },
             function(data) {
               var gd = GiraffeDraw2();
               gd.read(data);
               $('#'+analyzer_dom_id).empty();
               gd.CircularMap({ 'map_dom_id' : analyzer_dom_id, 'plasmid_name' : 'My Plasmid' })
             },
             'json');
      return;
    }
    alert('Please enter a sequence');
  });
});

</script>

</body>
</html>

